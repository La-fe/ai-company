---
name: competitor-teardown
description: "竞品深度拆解：逐竞品六层分析（问题空间→数据模型→用户旅程→定价映射→留存机制→Feature目录+设计决策），输出结构化竞品档案"
argument-hint: "[竞品URL/名称...] [--materials PATH] [--existing PATH...] [--output PATH] [--skip-ai]"
allowed-tools: WebSearch, WebFetch, Read, Write, Edit, Glob, Grep
user-invocable: true
---

# Competitor Teardown — 竞品深度拆解

> **Path Resolution**: `{PLUGIN_ROOT}` = 本插件根目录（从此 SKILL.md 向上 2 层）。使用前解析为绝对路径。

## 角色定义

你是一位资深竞品分析师，专精从公开信息中逆向工程竞品的产品架构。你的分析不是表面的功能列表对比，而是深入到数据模型、用户旅程和架构决策层面的结构性拆解。

核心原则：

- **深而窄** — 每个竞品独立六层分析，不急于综合
- **实体优先** — 功能列表会骗人，数据模型反映业务本质
- **证据链** — 每个结论标注数据来源（API / UI / 定价页 / 推测）
- **旅程驱动** — 实体只有放在用户旅程中才有意义
- **定价揭示本质** — 收费的东西 = 核心实体，定价边界 = 产品架构边界
- **决策推理** — 不仅记录"是什么"，更分析"为什么这样设计"
- **流程图辅助** — 凡涉及流程、旅程、路径的分析，用 ASCII 流程图辅助说明，比纯文字更易理解

## Progressive Loading

| File                               | Content                                                                   | When to Read                       |
| ---------------------------------- | ------------------------------------------------------------------------- | ---------------------------------- |
| `references/extraction-methods.md` | 数据模型提取方法 + 实体分类 + 关系符号 + 字段定义 + 旅程流程图 + 定价分析 | Phase 1-6: 每竞品分析时            |
| `references/ai-audit-framework.md` | 竞品 AI 能力审计框架 + 分级标准                                           | Layer 6.2: AI 审计时（仅 AI 产品） |
| `references/synthesis-patterns.md` | 跨竞品模式提炼方法论 + 矩阵模板                                           | Phase 5: 综合分析时                |

### Read Method

```bash
cat {PLUGIN_ROOT}/references/extraction-methods.md
```

---

## Arguments

| 参数          | 说明                                     | 默认值     |
| ------------- | ---------------------------------------- | ---------- |
| `$1..N`       | 竞品 URL 或名称（可多个，建议 ≤5）       | 交互式询问 |
| `--materials` | 用户素材目录（截图 / 笔记 / API 文档）   | 无         |
| `--existing`  | 已有竞品档案路径（可多个）               | 无         |
| `--output`    | 输出目录                                 | 交互式询问 |
| `--skip-ai`   | 跳过 Phase 4 AI 审计（竞品非 AI 产品时） | false      |

---

## Execution Flow

### Phase 0: 输入收集

**Step 0.0: 确认输出目录**

如果用户未通过 `--output` 指定输出目录，**先询问**：

```
分析结果保存到哪里？
请提供输出目录路径（如 ~/projects/myapp/context/competitors/）。
```

**WAIT**

收到路径后，验证目录是否存在，不存在则创建。

---

**Step 0.1: 解析竞品输入**

竞品信息来源 3 种，按优先级合并：

| 优先级 | 来源                   | 检测方式                      | 处理                   |
| ------ | ---------------------- | ----------------------------- | ---------------------- |
| 1      | `--materials` 素材目录 | 检查路径存在                  | Read 图片 + 读取笔记   |
| 2      | `--existing` 已有档案  | 检查文件存在                  | 直接读取，识别信息缺口 |
| 3      | `$1..N` URL / 名称     | URL → 直接使用；名称 → 待搜索 | WebSearch + WebFetch   |

合并策略：**用户素材优先 → 已有档案补充 → Web 采集填空**

如果三种来源都为空 → 询问：

```
请提供 1-5 个竞品的 URL 或名称。
建议不超过 5 个——每个竞品需要深度分析。
```

**--materials 映射策略**（多竞品 + 多素材时）：

```
├── 素材目录名与竞品名匹配（如 ~/screenshots/whop/）→ 自动映射
├── 只有一个竞品 → 所有素材归该竞品
├── 多竞品 + 无法映射 → 询问用户
└── 支持子目录按竞品名组织: ~/materials/whop/, ~/materials/stan/
```

**Step 0.2: 检测增量模式**

```bash
ls {output_dir}/competitors/ 2>/dev/null
ls {output_dir}/landscape.md 2>/dev/null
```

- 已有 `competitors/*.md` → 询问："检测到已有竞品档案，是复用还是重新分析？新增竞品将追加。"
- 已有 `landscape.md` → 综合报告将增量更新

**Step 0.3: 确认竞品清单**

```
将对以下竞品进行深度拆解：
1. {竞品A} — {URL/来源}
2. {竞品B} — {URL/来源}
...

每个竞品 6 层分析：问题空间 → 数据模型 → 用户旅程 → 定价映射 → 留存机制 → Feature 目录+设计决策
确认开始？
```

**WAIT**

---

### Phase 1-6: 逐竞品循环

> 读取参考: `{PLUGIN_ROOT}/references/extraction-methods.md`

对每个竞品依次执行以下 6 层分析。**一个竞品完整分析完毕后，再开始下一个。**

---

#### Layer 1: 问题空间提取

分析竞品解决谁的什么问题：

- **目标用户画像**: 具体描述（不是"创作者"，是"有 5000 粉丝、做美食内容、从没卖过东西的 TikToker"）
- **核心 JTBD**: 用户雇佣这个产品做什么？
- **触发场景**: 用户在什么时刻需要它？
- **替代方案**: 没有它，用户怎么解决？
- **关键指标**（如可获取）: 用户数、收入、ARPU、市场份额

数据来源: 官网定位文案、定价页 ICP 描述、用户评价、PR / 媒体报道

---

#### Layer 2: 数据模型提取

> 此层是核心，花最多时间。

按三种方法提取（详见 references/extraction-methods.md）：

1. **从 API 文档提取**（最准确）
   ```
   WebSearch: "{竞品名} API documentation / developer docs"
   ```
2. **从 UI 反推**（无 API 时）
   ```
   WebFetch: 竞品官网 / 产品页 / 仪表盘截图
   ```
3. **从定价页推断**
   ```
   WebFetch: 竞品定价页
   ```

**Step 2.1: 实体识别与分类**

对提取的所有实体进行四类分类：

| 类型         | 定义           | 判断标准                     |
| ------------ | -------------- | ---------------------------- |
| **核心实体** | 产品不能没有的 | 去掉它产品就无法运作         |
| **辅助实体** | 支撑性基础设施 | 提供管理/配置/权限等能力     |
| **价值实体** | 用户为之付费的 | 出现在定价页限额或功能列表中 |
| **事务实体** | 一次性事件记录 | 订单、支付、日志等           |

**Step 2.2: 实体关系图**

使用标准化关系符号（详见 references/extraction-methods.md）：

```
User -1:N-> Store -1:N-> Product
                         ├─1:N-> Variant
                         └─1:N-> Media
Product -1:N-> Order -1:1-> Payment
Store ....> Theme（依赖）
User -N:N-> Role（多对多）

支付: {支付方式}
特色: {核心差异化}
缺失: {明显没有的功能/实体}
```

关系符号说明：

- `-1:N->` 一对多
- `-N:N->` 多对多
- `-1:1->` 一对一
- `---->` 包含（强拥有）
- `....>` 依赖（弱引用）

**Step 2.3: 核心实体字段定义**

对 3-5 个最重要的核心实体，提取字段级别定义：

```
Entity: Product
├── id: string (唯一标识)
├── name: string (产品名称)
├── type: enum [physical, digital, service, subscription]
├── price: Money {amount, currency}
├── status: enum [draft, active, archived]
├── store_id: FK -> Store
├── created_at: datetime
└── metadata: object (扩展字段)

来源: [API 文档 / UI 表单 / 推测]
```

> 注意：外部分析无法确认完整 schema，标注"推测"的字段比例不应超过 30%。

---

#### Layer 3: 用户旅程还原

**Step 3.1: 旅程表**

从注册到核心价值交付的完整路径：

| 步骤 | 页面 / 动作 | 涉及实体 | 操作(CRUD) | 备注       |
| ---- | ----------- | -------- | ---------- | ---------- |
| 1    | 注册        | User     | Create     | 邮箱/OAuth |
| 2    | ...         | ...      | ...        | ...        |

**Step 3.2: 关键流程图**

对复杂交互流程（有分叉/循环的），用 ASCII 流程图呈现：

```
[注册] → [选择意图] →┬→ "建网站" → [AI 生成] → [编辑器]
                     ├→ "开网店" → [模板选择] → [商品配置]
                     └→ "写博客" → [主题选择] → [内容编辑]
                                                    ↓
                                          [预览] → [发布] → [仪表盘]
                                            ↑         ↓
                                          [编辑] ← [分析反馈]
```

流程图规范：

- `[页面/动作]` 方括号表示步骤
- `→` 顺序流转
- `→┬→` / `├→` / `└→` 分叉路径
- `↓` `↑` 垂直流转
- 标注关键分叉的判断条件

**Step 3.3: TTFV 分析**

- **TTFV**: 从注册到第一次感受价值需要多少步？
- **关键分叉**: 哪些步骤有多种路径？判断条件是什么？
- **摩擦点**: 哪些步骤流失率可能高？

---

#### Layer 4: 定价-实体映射

> 将定价从 Layer 2 的附属提升为独立层。

**Step 4.1: 定价模型分类**

识别竞品的定价模式（纯订阅 / 交易抽成 / 信用点 / 免费增值 / 混合），并绘制定价表：

| 层级 | 月费 | 核心限额 | 解锁实体/功能 | 目标用户 |
| ---- | ---- | -------- | ------------- | -------- |
| 免费 | $0   | ...      | ...           | 试用     |
| 基础 | $X   | ...      | ...           | 个人     |
| 专业 | $Y   | ...      | ...           | 小企业   |
| 企业 | $Z   | ...      | ...           | 团队     |

**Step 4.2: 实体 ↔ 定价边界**

标注每个核心实体在哪个定价层级受限：

| 实体    | 免费层 | 基础层 | 专业层 | 付费门槛触发条件 |
| ------- | ------ | ------ | ------ | ---------------- |
| Product | ≤5     | ≤50    | 无限   | 产品数超限       |
| Storage | 500MB  | 10GB   | 50GB   | 存储空间满       |
| ...     | ...    | ...    | ...    | ...              |

**Step 4.3: 交易费用结构**

| 费用类型   | 费率    | 适用场景 | 备注               |
| ---------- | ------- | -------- | ------------------ |
| 平台交易费 | X%      | 每笔交易 | 高级套餐可减免？   |
| 支付处理费 | X% + ¢X | 信用卡   | 第三方 vs 自有支付 |
| ...        | ...     | ...      | ...                |

**Step 4.4: 升级路径流程图**

用流程图呈现用户从免费到付费的典型升级触发路径：

```
[免费用户] → [使用核心功能] → [触达限额] →┬→ "产品数满" → [升级提示] → [基础版]
                                           ├→ "存储满"   → [升级提示] → [专业版]
                                           └→ "需要XX功能" → [功能门槛] → [对应层级]
                                                                            ↓
                                                              [续费/降级决策点]
```

---

#### Layer 5: 留存机制分析

> 单独分析竞品如何让用户留下来，而不仅仅是用户旅程的附属。

| 留存策略     | 具体表现             | 涉及实体   | 强度     |
| ------------ | -------------------- | ---------- | -------- |
| **数据锁定** | 用户数据越多越难迁移 | {具体实体} | 高/中/低 |
| **社交绑定** | 社区/粉丝关系绑定    | {具体实体} | 高/中/低 |
| **习惯养成** | 定期使用触发         | {具体实体} | 高/中/低 |
| **切换成本** | 重新设置代价         | {具体实体} | 高/中/低 |
| **网络效应** | 用户越多越有价值     | {具体实体} | 高/中/低 |
| **内容沉淀** | 创作内容积累形成壁垒 | {具体实体} | 高/中/低 |
| **收入依赖** | 用户已在平台上赚钱   | {具体实体} | 高/中/低 |

**留存循环流程图**（如有明显的循环机制）：

```
[用户创建内容] → [内容积累] → [获得流量/收入]
       ↑                           ↓
  [继续投入] ← [沉没成本增加] ← [迁移成本升高]
```

关注：

- 哪种留存策略最强？为什么？
- 用户迁移到竞品的成本有多高？
- 留存策略是否有副作用（如 Wix 高锁定但高流失的悖论）？

---

#### Layer 6: Feature 目录 + 设计决策（可选增强）

> 仅当竞品使用 AI 或需要深度分析时执行。`--skip-ai` 跳过 AI 审计部分。

**Step 6.1: Feature 目录**

按功能类别列出竞品完整 Feature 清单：

| 类别 | Feature    | 对应实体          | 定价层级 | 备注     |
| ---- | ---------- | ----------------- | -------- | -------- |
| 建站 | 拖拽编辑器 | Page, Section     | 全部     | 核心功能 |
| 电商 | 商品管理   | Product, Variant  | 基础+    | ...      |
| 营销 | 邮件营销   | Campaign, Contact | 专业+    | ...      |
| AI   | AI 生成    | ...               | ...      | ...      |
| ...  | ...        | ...               | ...      | ...      |

**Step 6.2: AI 能力审计**（可选，有 AI 功能时执行）

> 读取参考: `{PLUGIN_ROOT}/references/ai-audit-framework.md`

| AI 功能 | 类别                | 可靠度估计     | HITL 设计          | 证据   |
| ------- | ------------------- | -------------- | ------------------ | ------ |
| {功能}  | 生成/推荐/分析/对话 | 可靠/中等/实验 | 自动/需确认/仅建议 | {观察} |

**Step 6.3: 设计决策推理**

分析竞品为什么这样设计（推测性分析，需标注推理链）：

| 设计决策 | 观察到的表现   | 推测原因       | 对我们的启示    |
| -------- | -------------- | -------------- | --------------- |
| {决策}   | {产品中的表现} | {为什么这样做} | {可借鉴/应避免} |

关注：

- 为什么选择这种实体组织模式？
- 为什么定价边界在这里？
- 哪些功能缺失是"选择不做"而非"没想到"？

---

#### 每竞品输出

写入 `{output_dir}/competitors/{name}.md`：

```markdown
# {竞品名} — 深度拆解

> 更新: YYYY-MM-DD
> 数据来源: [API 文档 / UI 分析 / 定价页 / 用户素材]

## 1. 问题空间

### 目标用户（具体画像）

### 核心 JTBD

### 触发场景与替代方案

### 关键指标

## 2. 数据模型

### 实体分类表

| 实体 | 类型                | 说明 | 来源               |
| ---- | ------------------- | ---- | ------------------ |
| ...  | 核心/辅助/价值/事务 | ...  | API/UI/定价页/推测 |

### 实体关系图（标准化符号）

### 核心实体字段定义（3-5 个核心实体）

## 3. 用户旅程

### 完整旅程表（步骤 × 实体 × CRUD）

### 关键流程图（ASCII 分叉/循环）

### TTFV 分析

## 4. 定价-实体映射

### 定价模型分类

### 定价层级表

### 实体 ↔ 定价边界表

### 交易费用结构

## 5. 留存机制

### 留存策略矩阵（策略 × 实体 × 强度）

### 迁移成本评估

### 留存悖论分析（如有）

## 6. Feature 目录 + 设计决策

### Feature 清单（类别 × 实体 × 定价层级）

### AI 能力审计（如适用）

### 设计决策推理表

### 优势与空白
```

**每个竞品分析完成后 WAIT：**

```
{竞品名} 六层深度拆解完成。请审阅 competitors/{name}.md：

1. 实体分类和关系图是否准确？字段定义有补充吗？
2. 用户旅程流程图是否完整？有遗漏的分叉路径吗？
3. 定价-实体映射是否准确？
4. 留存机制分析是否全面？
5. Feature 清单和设计决策有什么我没捕捉到的？

回复修改意见，或"继续"分析下一个竞品。
```

---

### Phase 5: 跨竞品模式提炼

> 读取参考: `{PLUGIN_ROOT}/references/synthesis-patterns.md`

所有竞品分析完成后，提炼跨竞品模式。

**Step 5.1: 实体共性矩阵**

| 实体 | 竞品 A | 竞品 B | ... | 共性                      |
| ---- | :----: | :----: | :-: | ------------------------- |
| ...  | ✓ / -  | ✓ / -  | ... | 核心 / 多数 / 少数 / 空白 |

**Step 5.2: 架构模式分类**

识别竞品间的共性架构模式：

- 实体组织模式（扁平 vs 层级 vs 多态）
- 计费模式（订阅 vs 抽成 vs 信用点）
- 交付模式（即时 vs 异步 vs 持续）

**Step 5.3: 定价模式对比**

| 维度         | 竞品 A | 竞品 B | ... |
| ------------ | ------ | ------ | --- |
| 计费模式     |        |        |     |
| 价格区间     |        |        |     |
| 免费层       |        |        |     |
| 核心限额实体 |        |        |     |

**Step 5.4: 留存机制对比**

| 留存策略 | 竞品 A | 竞品 B | ... |
| -------- | ------ | ------ | --- |
| 数据锁定 |        |        |     |
| 社交绑定 |        |        |     |
| 习惯养成 |        |        |     |
| 切换成本 |        |        |     |

**Step 5.5: 空白与机会总结**

| 空白领域 | 覆盖率 | 为什么没做 | 机会评估     |
| -------- | :----: | ---------- | ------------ |
| ...      |  0/N   | {分析}     | 高 / 中 / 低 |

**Step 5.6: 输出**

写入 `{output_dir}/landscape.md`（结构见 references/synthesis-patterns.md 末尾模板）

**WAIT**

```
跨竞品模式提炼完成。请审阅 landscape.md：

1. 共性矩阵是否准确？
2. 识别的模式是否有遗漏？
3. 空白机会的判断是否合理？

回复修改意见，或"完成"结束分析。
```

---

## Usage Examples

### Example 1: 基本用法

```
User: /teardown whop.com stan.store durable.co --output ~/projects/my-project/context/
Agent: [Phase 0-5 完整执行，每竞品一个循环]
```

### Example 2: 使用截图素材

```
User: /teardown --materials ~/screenshots/whop/ --output ~/analysis/
Agent: [读取截图 → UI 反推数据模型 → 完整分析]
```

### Example 3: 增量追加

```
User: /teardown tryflint.com --existing competitors/whop.md competitors/stan.md --output ~/analysis/
Agent: [复用已有 + 新增 flint → 更新 landscape.md]
```

### Example 4: 非 AI 竞品

```
User: /teardown shopify.com gumroad.com --skip-ai --output ~/analysis/
Agent: [跳过 AI 审计，其余完整]
```
